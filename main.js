!function(){"use strict";class e{constructor(e,t,s,n,i){this.isLiked=e.isLiked,this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleCardClick=s,this._handleDeleteClick=n,this._handleCardLike=i,this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._likeIconElement=this._cardElement.querySelector(".card__like-icon"),this._trashButtonElement=this._cardElement.querySelector(".card__trash"),this._imageElement=this._cardElement.querySelector(".card__image")}_setEventListeners(){this._likeIconElement.addEventListener("click",(e=>{e.preventDefault(),this._handleCardLike()})),this._trashButtonElement.addEventListener("click",(()=>{this._handleDeleteClick()})),this._imageElement.addEventListener("click",(e=>{e.preventDefault(),this._handleOpenDisplay()}))}_handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}_handleLikeIcon(){this.isLiked?this._likeIconElement.classList.add("card__like-icon_active"):this._likeIconElement.classList.remove("card__like-icon_active")}showLikes(e){this.isLiked=e,this._handleLikeIcon()}_handleOpenDisplay(){this._handleCardClick(this._link,this._name)}deleteCardElement(){this._handleDeleteCard()}getView(){const e=this._cardElement.querySelector(".card__image"),t=this._cardElement.querySelector(".card__title");return e.src=this._link,e.alt=this._name,t.textContent=this._name,this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._settings=e,this._formElement=t}_showInputError(e,t){const s=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._settings.inputErrorClass),s.textContent=t,s.classList.add(this._settings.errorClass)}_hideInputError(e,t){const s=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._settings.inputErrorClass),s.classList.remove(t),s.textContent=null}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(e){return!!e&&e.some((e=>!e.validity.valid))}toggleButtonState(){const e=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),t=this._formElement.querySelector(this._settings.submitButtonSelector);this._hasInvalidInput(e)?(t.classList.add(this._settings.inactiveButtonClass),t.setAttribute("disabled","true")):(t.classList.remove(this._settings.inactiveButtonClass),t.removeAttribute("disabled"))}_setEventListeners(){const e=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),t=this._formElement.querySelector(this._settings.submitButtonSelector);this.toggleButtonState(e,t),e.forEach((s=>{s.addEventListener("input",(()=>{this._checkInputValidity(s),this.toggleButtonState(e,t)}))}))}enableValidation(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}}class s{constructor(e){this._popup=document.querySelector(e),this._popupCloseButton=this._popup.querySelector(".modal__close-button")}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popup.addEventListener("mousedown",(e=>{e.target.classList.contains("modal")&&this.close()})),this._popupCloseButton.addEventListener("click",(()=>{this.close()}))}}class n extends s{constructor(e,t,s){super(e,s),this._popupForm=this._popup.querySelector(".modal__container"),this._handleFormSubmit=t,this._inputs=this._popupForm.querySelectorAll(".modal__input"),this.saveButton=this._popupForm.querySelector(".modal__save-button"),this._loadingText=s}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t),this.close()}))}showLoading(){this.saveButton.textContent=this._loadingText}hideLoading(e){this.saveButton.textContent=e}close(){this._popupForm.reset(),super.close()}}class i{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._cardElements=t}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._cardElements.prepend(e)}}const r={inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_active",inactiveButtonClass:"modal__save-button_inactive",formSelector:".modal__container",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",fieldsetSelector:".modal__fieldset"},o=document.querySelector(".gallery__cards"),a=document.querySelector("#name-input"),l=(document.querySelector("#title-input"),document.querySelector("#image-input"),document.querySelector("#about-input")),c=document.querySelector(".img-modal__container"),d=document.querySelector(".profile__occupation"),h=document.querySelector(".profile__username"),u=document.querySelector(".profile__avatar"),_=document.querySelector(".profile-modal__container"),m=(document.querySelector(".delete-modal"),document.querySelector(".modal__confirm-button"),document.querySelector(".avatar-modal__container")),p=document.querySelector(".profile__edit-avatar-icon"),E=document.querySelector(".profile__edit-button"),v=document.querySelector(".profile__add-button");let f,L;const g=new t(r,c);g.enableValidation(),new t(r,m).enableValidation();const S=new class{constructor(e,t,s){this._nameElement=e,this._descriptionElment=t,this._avatarElement=s}getUserInfo(){const e={};return e.name=this._nameElement.textContent,e.description=this._descriptionElment.textContent,e}setUserInfo(e,t){this._nameElement.textContent=e,this._descriptionElment.textContent=t}setUserAvatar(e){this._avatarElement.src=e}}(h,d,u),y=new n(".profile-modal",(function(e){let{name:t,description:s}=e;y.showLoading(),I.updateUserInfo(t,s).then((()=>{S.setUserInfo(t,s),y.close()})).catch(console.error).finally((()=>{y.hideLoading("Save")}))}),"Saving..."),k=new n(".avatar-modal",(function(e){k.showLoading(),I.updateUserAvatar(e.link).then((()=>{S.setUserAvatar(e.link),k.close()})).catch(console.error).finally((()=>{k.hideLoading("Save")}))}),"Saving..."),C=new n(".img-modal",(function(e){let{name:t,link:s}=e;C.showLoading(),I.createCards({name:t,link:s}).then((e=>{const t=U(e);L.addItem(t),C.close()})).catch(console.error).finally((()=>{C.hideLoading("Save")}))}),"Saving..."),q=new class extends s{constructor(e){super(e),this._popupImage=this._popup.querySelector(".modal__image-display"),this._caption=this._popup.querySelector(".modal__paragraph")}open(e,t){this._popupImage.src=e,this._popupImage.alt=t,this._caption.textContent=t,super.open()}}(".display-modal"),b=new class extends s{constructor(e,t){super(e),this._popupForm=this._popup.querySelector(".modal__container"),this._confirmButton=this._popupForm.querySelector(".modal__confirm-button"),this._confirmButtonText=this._confirmButton.textContent,this._loadingText=t}close(){super.close()}setConfirmAction(e){this._handleFormSubmit=e}showLoading(){this._confirmButton.textContent=this._loadingText}hideLoading(e){this._confirmButton.textContent=e}setEventListeners(){super.setEventListeners(),this._confirmButton.addEventListener("click",(()=>{this._handleFormSubmit&&this._handleFormSubmit()}))}}(".delete-modal","Deleting...");b.setEventListeners();const I=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}async _handleApiResponses(e){return e.ok?await e.json():Promise.reject(`Error: ${e.status}`)}async _request(e,t){try{const s=await fetch(e,t);return this._handleApiResponses(s)}catch(e){throw console.error("There is an API issue"),e}}getInitialCards(){return this._request(`${this._baseUrl}/cards`,{headers:this._headers})}createCards(e){let{name:t,link:s}=e;return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s})})}deleteCard(e){return this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}updateLikes(e,t){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers})}getUserInfo(){return this._request(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers})}updateUserInfo(e,t){return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})})}updateUserAvatar(e){return this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"d15f0643-7ba6-4697-8a04-5f83082b3085","Content-Type":"application/json"}});function w(e,t){q.open(e,t)}function U(t){const s=new e(t,"#profile__card-template",w,(function(){b.setConfirmAction((()=>{b.showLoading(),I.deleteCard(t._id).then((e=>{s.deleteCardElement(e._id),b.close()})).catch(console.error).finally((()=>{b.hideLoading("Yes")}))})),b.open()}),(function(){I.updateLikes(t._id,s.isLiked).then((e=>{s.showLikes(e.isLiked),s.isLiked=e.isLiked})).catch(console.error)}));return s.showLikes(t.isLiked),s.getView()}Promise.all([I.getUserInfo(),I.getInitialCards()]).then((e=>{let[t,s]=e;S.setUserInfo(t.name,t.about),S.setUserAvatar(t.avatar),f=t._id,console.log("user info:",t),console.log("Initial cards:",s),L=new i({items:s,renderer:e=>{const t=U(e);L.addItem(t)}},o),L.renderItems()})).catch(console.error),E.addEventListener("click",(function(){const{name:e,description:t}=S.getUserInfo();a.value=e,l.value=t,y.open()})),y.setEventListeners(),v.addEventListener("click",(function(e){g.toggleButtonState(),C.open()})),C.setEventListeners(),q.setEventListeners(),k.setEventListeners(),p.addEventListener("click",(function(){g.toggleButtonState(),k.open()})),new t(r,_).enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNsQjZGLEVBQWdCNUUsTUFDbEIsSUEyRzZCLElBQUlyQyxFQUFjQyxFQUFVbUYsR0FDcENyRCxrQiIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL3BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgY2FyZERhdGEsXHJcbiAgICBjYXJkU2VsZWN0b3IsXHJcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgIGhhbmRsZUNhcmRMaWtlXHJcbiAgKSB7XHJcbiAgICB0aGlzLmlzTGlrZWQgPSBjYXJkRGF0YS5pc0xpa2VkO1xyXG4gICAgdGhpcy5fbmFtZSA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gY2FyZERhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSA9IGhhbmRsZUNhcmRMaWtlO1xyXG5cclxuICAgIC8vZ2V0dGluZyB0aGUgY2FyZCB2aWV3XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgdGhpcy5fbGlrZUljb25FbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWljb25cIik7XHJcbiAgICB0aGlzLl90cmFzaEJ1dHRvbkVsZW1lbnQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoXCIpO1xyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIC8vY2FyZCBsaWtlIGJ1dHRvblxyXG4gICAgdGhpcy5fbGlrZUljb25FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRMaWtlKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvL2RlbGV0ZSBidXR0b25cclxuICAgIHRoaXMuX3RyYXNoQnV0dG9uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljaygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy9vcGVuaW5nIGRpc3BsYXlcclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVPcGVuRGlzcGxheSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRGVsZXRlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2VJY29uKCkge1xyXG4gICAgaWYgKHRoaXMuaXNMaWtlZCkge1xyXG4gICAgICB0aGlzLl9saWtlSWNvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtaWNvbl9hY3RpdmVcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9saWtlSWNvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtaWNvbl9hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzaG93TGlrZXMoaXNMaWtlZCkge1xyXG4gICAgdGhpcy5pc0xpa2VkID0gaXNMaWtlZDtcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VJY29uKCk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlT3BlbkRpc3BsYXkoKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5fbGluaywgdGhpcy5fbmFtZSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkRWxlbWVudCgpIHtcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQoKTtcclxuICB9XHJcblxyXG4gIGdldFZpZXcoKSB7XHJcbiAgICAvL1NldHRpbmcgdGhlIGltZyBzcmMgYW5kIGFsdCBhdHRyaWJ1dGVzXHJcbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgY29uc3QgY2FyZFRpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIGNhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgLy9zZXR0aW5nICBldmVudCBpc3RlbmVycyxcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgLy9yZXR1cm5pbmcgdGhlIGNhcmQsXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICAvL2Z1bmMgdG8gaGlkZSBpbnB1dCBlcnJvclxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgLy9mdW5jIHRvIGhpZGUgaW5wdXQgZXJyb3JcclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShlcnJvck1lc3NhZ2UpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gbnVsbDtcclxuICB9XHJcblxyXG4gIC8vY2hlY2tpbmcgZmllbGQgdmFsaWRpdHlcclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vZnVuYyB0byBjaGVjayBpZiBmb3JtIGhhcyBhbiBpbnZhbGlkIGlucHV0XHJcbiAgX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpIHtcclxuICAgIGlmICghaW5wdXRMaXN0KSB7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcblxyXG4gIC8vZnVuYyB0byB0b2dnbGUgc3VibWl0IGJ1dHRvblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9zZXR0aW5ncy5pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIGJ1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJ0cnVlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICBidXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy9hZGRpbmcgaGFuZGxlcnNcclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG4gICAgY29uc3QgYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpO1xyXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuXHJcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAvL2VuYWJsZSBmb3JtIHZhbGlkYXRpb25cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGV2dCkge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwQ2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idXR0b25cIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fcG9wdXBDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQsIGxvYWRpbmdUZXh0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yLCBsb2FkaW5nVGV4dCk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jb250YWluZXJcIik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX2lucHV0cyA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcclxuICAgIHRoaXMuc2F2ZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2xvYWRpbmdUZXh0ID0gbG9hZGluZ1RleHQ7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBpbnB1dHMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dHNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBpbnB1dHM7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBjb25zdCBpbnB1dHMgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KGlucHV0cyk7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2hvd0xvYWRpbmcoKSB7XHJcbiAgICB0aGlzLnNhdmVCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9sb2FkaW5nVGV4dDtcclxuICB9XHJcblxyXG4gIGhpZGVMb2FkaW5nKG9yaWdpbmFsVGV4dCkge1xyXG4gICAgdGhpcy5zYXZlQnV0dG9uLnRleHRDb250ZW50ID0gb3JpZ2luYWxUZXh0O1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNhcmRFbGVtZW50cykge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudHMgPSBjYXJkRWxlbWVudHM7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudHMucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiLy9JbWFnZSBjYXJkc1xyXG5leHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbi8vRm9ybSB2YWxpZGF0aW9uIHNldHRpbmdzXHJcbmV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dC1lcnJvcl9hY3RpdmVcIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zYXZlLWJ1dHRvbl9pbmFjdGl2ZVwiLFxyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2NvbnRhaW5lclwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZS1idXR0b25cIixcclxuICBmaWVsZHNldFNlbGVjdG9yOiBcIi5tb2RhbF9fZmllbGRzZXRcIixcclxufTtcclxuXHJcbi8vRmluZGluZyB0aGUgY2FyZCB0ZW1wbGF0ZSBhbmQgZ2FsbGVyeSBzZWN0aW9uXHJcbmV4cG9ydCBjb25zdCBnYWxsZXJ5RGlzcGxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fY2FyZHNcIik7XHJcblxyXG4vL0ZpbmRpbmcgZm9ybSBjb21wb25lbnRzXHJcbmV4cG9ydCBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI25hbWUtaW5wdXRcIik7XHJcbmV4cG9ydCBjb25zdCB0aXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN0aXRsZS1pbnB1dFwiKTtcclxuZXhwb3J0IGNvbnN0IGltZ1VybElucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZS1pbnB1dFwiKTtcclxuZXhwb3J0IGNvbnN0IGRlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2Fib3V0LWlucHV0XCIpO1xyXG5leHBvcnQgY29uc3QgaW1nTW9kYWxGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbWctbW9kYWxfX2NvbnRhaW5lclwiKTtcclxuZXhwb3J0IGNvbnN0IGpvYk9mVXNlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fb2NjdXBhdGlvblwiKTtcclxuZXhwb3J0IGNvbnN0IG5hbWVPZlVzZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3VzZXJuYW1lXCIpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyT2ZVc2VyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXJcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZS1tb2RhbF9fY29udGFpbmVyXCIpO1xyXG5leHBvcnQgY29uc3QgZGVsZXRlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGVsZXRlLW1vZGFsXCIpO1xyXG5leHBvcnQgY29uc3QgZGVsZXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY29uZmlybS1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hdmF0YXItbW9kYWxfX2NvbnRhaW5lclwiKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhclVwZGF0ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fZWRpdC1hdmF0YXItaWNvblwiXHJcbik7XHJcblxyXG4vL2ZpbmRpbmcgdGhlIGVkaXQgYnV0dG9uXHJcbmV4cG9ydCBjb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuZXhwb3J0IGNvbnN0IGFkZEltZ0J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuIiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvcG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgc2V0dGluZ3MsXHJcbiAgZ2FsbGVyeURpc3BsYXksXHJcbiAgbmFtZUlucHV0LFxyXG4gIHRpdGxlSW5wdXQsXHJcbiAgaW1nVXJsSW5wdXQsXHJcbiAgaW5pdGlhbENhcmRzLFxyXG4gIGRlc2NyaXB0aW9uSW5wdXQsXHJcbiAgaW1nTW9kYWxGb3JtLFxyXG4gIGVkaXRCdXR0b24sXHJcbiAgYWRkSW1nQnV0dG9uLFxyXG4gIHByb2ZpbGVGb3JtLFxyXG4gIG5hbWVPZlVzZXIsXHJcbiAgam9iT2ZVc2VyLFxyXG4gIGF2YXRhck9mVXNlcixcclxuICBkZWxldGVCdXR0b24sXHJcbiAgZGVsZXRlRm9ybSxcclxuICBhdmF0YXJGb3JtLFxyXG4gIGF2YXRhclVwZGF0ZUJ1dHRvbixcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5cclxubGV0IHVzZXJJZDtcclxubGV0IHNlY3Rpb247XHJcbi8vIENyZWF0aW5nIGEgbmV3IGluc3RhbmNlcyBvZiBDbGFzc2VzLS0tLS0tLS0tLS1cclxuY29uc3QgY2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgaW1nTW9kYWxGb3JtKTtcclxuY2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBhdmF0YXJGb3JtKTtcclxuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhuYW1lT2ZVc2VyLCBqb2JPZlVzZXIsIGF2YXRhck9mVXNlcik7XHJcblxyXG5jb25zdCBwcm9maWxlRm9ybU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIucHJvZmlsZS1tb2RhbFwiLFxyXG4gIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0LFxyXG4gIFwiU2F2aW5nLi4uXCJcclxuKTtcclxuY29uc3QgYXZhdGFyRm9ybU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIuYXZhdGFyLW1vZGFsXCIsXHJcbiAgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdCxcclxuICBcIlNhdmluZy4uLlwiXHJcbik7XHJcblxyXG5jb25zdCBpbWdGb3JtTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIi5pbWctbW9kYWxcIixcclxuICBoYW5kbGVJbWdGb3JtU3VibWl0LFxyXG4gIFwiU2F2aW5nLi4uXCJcclxuKTtcclxuY29uc3QgaW1nRGlzcGxheVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiLmRpc3BsYXktbW9kYWxcIik7XHJcbmNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXHJcbiAgXCIuZGVsZXRlLW1vZGFsXCIsXHJcbiAgXCJEZWxldGluZy4uLlwiXHJcbik7XHJcbmRlbGV0ZUNhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiZDE1ZjA2NDMtN2JhNi00Njk3LThhMDQtNWY4MzA4MmIzMDg1XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbi8vTG9hZGluZyB1c2VyIGluZm8gYW5kIGNhcmRzIGZyb20gdGhlIHNlcnZlciBzaW11bHRhbmVvdXNseVxyXG5cclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mbygpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxyXG4gIC50aGVuKChbdXNlckRhdGEsIGluaXRpYWxDYXJkc10pID0+IHtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhLm5hbWUsIHVzZXJEYXRhLmFib3V0KTtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIodXNlckRhdGEuYXZhdGFyKTtcclxuICAgIHVzZXJJZCA9IHVzZXJEYXRhLl9pZDtcclxuICAgIGNvbnNvbGUubG9nKFwidXNlciBpbmZvOlwiLCB1c2VyRGF0YSk7XHJcbiAgICBjb25zb2xlLmxvZyhcIkluaXRpYWwgY2FyZHM6XCIsIGluaXRpYWxDYXJkcyk7XHJcblxyXG4gICAgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcclxuICAgICAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbiAgICAgICAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgICAgZ2FsbGVyeURpc3BsYXlcclxuICAgICk7XHJcblxyXG4gICAgc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG5cclxuLy9mdW5jdGlvbiB0aGF0IG9wZW5zIHByb2ZpbGUgbW9kYWxcclxuZnVuY3Rpb24gZGlzcGxheVByb2ZpbGVNb2RhbCgpIHtcclxuICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uIH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIG5hbWVJbnB1dC52YWx1ZSA9IG5hbWU7XHJcbiAgZGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IGRlc2NyaXB0aW9uO1xyXG4gIHByb2ZpbGVGb3JtTW9kYWwub3BlbigpO1xyXG59XHJcblxyXG4vL2Z1bmN0aW9uIHRoYXQgb3BlbnMgaW1nIG1vZGFsXHJcbmZ1bmN0aW9uIGRpc3BsYXlJbWdNb2RhbChlKSB7XHJcbiAgY2FyZEZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICBpbWdGb3JtTW9kYWwub3BlbigpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkaXNwbGF5QXZhdGFyTW9kYWwoKSB7XHJcbiAgY2FyZEZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICBhdmF0YXJGb3JtTW9kYWwub3BlbigpO1xyXG59XHJcbi8vIGZ1bmN0aW9uIHRoYXQgY2xvc2VzIGltZyBkaXNwbGF5IG1vZGFsXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRDbGljayhpbWFnZVVybCwgY2FwdGlvbikge1xyXG4gIGltZ0Rpc3BsYXlQb3B1cC5vcGVuKGltYWdlVXJsLCBjYXB0aW9uKTtcclxufVxyXG5cclxuLy9mdW5jdGlvbiB0aGF0IHNhdmVzIHByb2ZpbGUgbW9kYWwgaW5wdXRzXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCh7IG5hbWUsIGRlc2NyaXB0aW9uIH0pIHtcclxuICBwcm9maWxlRm9ybU1vZGFsLnNob3dMb2FkaW5nKCk7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlVXNlckluZm8obmFtZSwgZGVzY3JpcHRpb24pXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKG5hbWUsIGRlc2NyaXB0aW9uKTtcclxuICAgICAgcHJvZmlsZUZvcm1Nb2RhbC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBwcm9maWxlRm9ybU1vZGFsLmhpZGVMb2FkaW5nKFwiU2F2ZVwiKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vL2Z1bmN0aW9uIHRoYXQgc2F2ZSBpbWdzIG1vZGFsIGlucHV0c1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlSW1nRm9ybVN1Ym1pdCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gIGltZ0Zvcm1Nb2RhbC5zaG93TG9hZGluZygpO1xyXG5cclxuICBhcGlcclxuICAgIC5jcmVhdGVDYXJkcyh7IG5hbWUsIGxpbmsgfSlcclxuICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBuZXdDYXJkID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XHJcbiAgICAgIHNlY3Rpb24uYWRkSXRlbShuZXdDYXJkKTtcclxuICAgICAgaW1nRm9ybU1vZGFsLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGltZ0Zvcm1Nb2RhbC5oaWRlTG9hZGluZyhcIlNhdmVcIik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLy9mdW50aW9uIHRvIGNoYW5nZSBhdmF0YXJcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQoaW5wdXRWYWx1ZSkge1xyXG4gIGF2YXRhckZvcm1Nb2RhbC5zaG93TG9hZGluZygpO1xyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZVVzZXJBdmF0YXIoaW5wdXRWYWx1ZS5saW5rKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKGlucHV0VmFsdWUubGluayk7XHJcbiAgICAgIGF2YXRhckZvcm1Nb2RhbC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBhdmF0YXJGb3JtTW9kYWwuaGlkZUxvYWRpbmcoXCJTYXZlXCIpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vZnVuY3Rpb24gdGhhdCBjcmVhdGVzIGNhcmRzXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoaXRlbSkge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIGl0ZW0sXHJcbiAgICBcIiNwcm9maWxlX19jYXJkLXRlbXBsYXRlXCIsXHJcbiAgICBoYW5kbGVDYXJkQ2xpY2ssXHJcblxyXG4gICAgZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZCgpIHtcclxuICAgICAgZGVsZXRlQ2FyZFBvcHVwLnNldENvbmZpcm1BY3Rpb24oKCkgPT4ge1xyXG4gICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5zaG93TG9hZGluZygpO1xyXG5cclxuICAgICAgICAvL0V4ZWN1dGluZyB0aGUgQVBJIENhbGwgd2l0aGluIHRoZSBjb25maXJtYXRpb24gYWN0aW9uXHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAuZGVsZXRlQ2FyZChpdGVtLl9pZClcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgY2FyZC5kZWxldGVDYXJkRWxlbWVudChyZXMuX2lkKTtcclxuICAgICAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5oaWRlTG9hZGluZyhcIlllc1wiKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgICAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oKTtcclxuICAgIH0sXHJcblxyXG4gICAgZnVuY3Rpb24gaGFuZGxlQ2FyZExpa2UoKSB7XHJcbiAgICAgIGFwaVxyXG4gICAgICAgIC51cGRhdGVMaWtlcyhpdGVtLl9pZCwgY2FyZC5pc0xpa2VkKVxyXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgIGNhcmQuc2hvd0xpa2VzKHJlcy5pc0xpa2VkKTtcclxuICAgICAgICAgIGNhcmQuaXNMaWtlZCA9IHJlcy5pc0xpa2VkO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG4gICAgfVxyXG4gICk7XHJcbiAgY2FyZC5zaG93TGlrZXMoaXRlbS5pc0xpa2VkKTtcclxuXHJcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xyXG59XHJcblxyXG4vL0FkZGluZyBFdmVudCBMaXN0ZW5lcnNcclxuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZGlzcGxheVByb2ZpbGVNb2RhbCk7XHJcbnByb2ZpbGVGb3JtTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuYWRkSW1nQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBkaXNwbGF5SW1nTW9kYWwpO1xyXG5pbWdGb3JtTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuaW1nRGlzcGxheVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmF2YXRhckZvcm1Nb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5hdmF0YXJVcGRhdGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGRpc3BsYXlBdmF0YXJNb2RhbCk7XHJcblxyXG4vL0NyZWF0aW5nIGFuIGluc3RhbmNlIG9mIHRoZSBmb3JtIHZhbGlkYXRvclxyXG5jb25zdCBwcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBwcm9maWxlRm9ybSk7XHJcbnByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKG5hbWVFbGVtZW50LCBkZXNjcmlwdGlvbkVsZW1lbnQsIGF2YXRhcikge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBuYW1lRWxlbWVudDtcclxuICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWxtZW50ID0gZGVzY3JpcHRpb25FbGVtZW50O1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGF2YXRhcjtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgY29uc3QgaW5mb0RhdGEgPSB7fTtcclxuICAgIGluZm9EYXRhW1wibmFtZVwiXSA9IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50O1xyXG4gICAgaW5mb0RhdGFbXCJkZXNjcmlwdGlvblwiXSA9IHRoaXMuX2Rlc2NyaXB0aW9uRWxtZW50LnRleHRDb250ZW50O1xyXG4gICAgcmV0dXJuIGluZm9EYXRhO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8obmFtZSwgZGVzY3JpcHRpb24pIHtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWxtZW50LnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XHJcbiAgfVxyXG5cclxuICBzZXRVc2VyQXZhdGFyKGF2YXRhcikge1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtZGlzcGxheVwiKTtcclxuICAgIHRoaXMuX2NhcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19wYXJhZ3JhcGhcIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKGltZ1VybCwgY2FwdGlvbikge1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBpbWdVcmw7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IGNhcHRpb247XHJcbiAgICB0aGlzLl9jYXB0aW9uLnRleHRDb250ZW50ID0gY2FwdGlvbjtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgbG9hZGluZ1RleHQpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY29udGFpbmVyXCIpO1xyXG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5tb2RhbF9fY29uZmlybS1idXR0b25cIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX2NvbmZpcm1CdXR0b25UZXh0ID0gdGhpcy5fY29uZmlybUJ1dHRvbi50ZXh0Q29udGVudDtcclxuICAgIHRoaXMuX2xvYWRpbmdUZXh0ID0gbG9hZGluZ1RleHQ7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBzZXRDb25maXJtQWN0aW9uKGNhbGxCYWNrKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gY2FsbEJhY2s7XHJcbiAgfVxyXG5cclxuICBzaG93TG9hZGluZygpIHtcclxuICAgIHRoaXMuX2NvbmZpcm1CdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9sb2FkaW5nVGV4dDtcclxuICB9XHJcblxyXG4gIGhpZGVMb2FkaW5nKG9yaWdpbmFsVGV4dCkge1xyXG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbi50ZXh0Q29udGVudCA9IG9yaWdpbmFsVGV4dDtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2NvbmZpcm1CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgaWYgKHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgX2hhbmRsZUFwaVJlc3BvbnNlcyhyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIGF3YWl0IHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBfcmVxdWVzdCh1cmwsIG9wdGlvbnMpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHVybCwgb3B0aW9ucyk7XHJcbiAgICAgIHJldHVybiB0aGlzLl9oYW5kbGVBcGlSZXNwb25zZXMocmVzKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJUaGVyZSBpcyBhbiBBUEkgaXNzdWVcIik7XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gQ2FyZCByb3V0ZSBtZXRob2RzXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNyZWF0ZUNhcmRzKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlTGlrZXMoY2FyZElkLCBpc0xpa2VkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvL1VzZXIgcm91dGUgbWV0aG9kc1xyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVVzZXJJbmZvKG5hbWUsIGRlc2NyaXB0aW9uKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGFib3V0OiBkZXNjcmlwdGlvbixcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVVzZXJBdmF0YXIoYXZhdGFyVXJsKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBhdmF0YXJVcmwsXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJjYXJkRGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlQ2FyZExpa2UiLCJ0aGlzIiwiaXNMaWtlZCIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUNhcmRMaWtlIiwiX2NhcmRFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9saWtlSWNvbkVsZW1lbnQiLCJfdHJhc2hCdXR0b25FbGVtZW50IiwiX2ltYWdlRWxlbWVudCIsIl9zZXRFdmVudExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwicHJldmVudERlZmF1bHQiLCJfaGFuZGxlT3BlbkRpc3BsYXkiLCJfaGFuZGxlRGVsZXRlQ2FyZCIsInJlbW92ZSIsIl9oYW5kbGVMaWtlSWNvbiIsImNsYXNzTGlzdCIsImFkZCIsInNob3dMaWtlcyIsImRlbGV0ZUNhcmRFbGVtZW50IiwiZ2V0VmlldyIsImNhcmRJbWFnZSIsImNhcmRUaXRsZSIsInNyYyIsImFsdCIsInRleHRDb250ZW50IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfc2V0dGluZ3MiLCJfZm9ybUVsZW1lbnQiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hhc0ludmFsaWRJbnB1dCIsImlucHV0TGlzdCIsInNvbWUiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiYnV0dG9uRWxlbWVudCIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsInNldEF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsImZvckVhY2giLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX3BvcHVwQ2xvc2VCdXR0b24iLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0IiwibG9hZGluZ1RleHQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9pbnB1dHMiLCJzYXZlQnV0dG9uIiwiX2xvYWRpbmdUZXh0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRzIiwiaW5wdXQiLCJ2YWx1ZSIsInNob3dMb2FkaW5nIiwiaGlkZUxvYWRpbmciLCJvcmlnaW5hbFRleHQiLCJyZXNldCIsIlNlY3Rpb24iLCJfcmVmIiwiY2FyZEVsZW1lbnRzIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jYXJkRWxlbWVudHMiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJmb3JtU2VsZWN0b3IiLCJmaWVsZHNldFNlbGVjdG9yIiwiZ2FsbGVyeURpc3BsYXkiLCJuYW1lSW5wdXQiLCJkZXNjcmlwdGlvbklucHV0IiwiaW1nTW9kYWxGb3JtIiwiam9iT2ZVc2VyIiwibmFtZU9mVXNlciIsImF2YXRhck9mVXNlciIsInByb2ZpbGVGb3JtIiwiYXZhdGFyRm9ybSIsImF2YXRhclVwZGF0ZUJ1dHRvbiIsImVkaXRCdXR0b24iLCJhZGRJbWdCdXR0b24iLCJ1c2VySWQiLCJzZWN0aW9uIiwiY2FyZEZvcm1WYWxpZGF0b3IiLCJ1c2VySW5mbyIsIm5hbWVFbGVtZW50IiwiZGVzY3JpcHRpb25FbGVtZW50IiwiYXZhdGFyIiwiX25hbWVFbGVtZW50IiwiX2Rlc2NyaXB0aW9uRWxtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJnZXRVc2VySW5mbyIsImluZm9EYXRhIiwic2V0VXNlckluZm8iLCJkZXNjcmlwdGlvbiIsInNldFVzZXJBdmF0YXIiLCJwcm9maWxlRm9ybU1vZGFsIiwiX3JlZjIiLCJhcGkiLCJ1cGRhdGVVc2VySW5mbyIsInRoZW4iLCJjYXRjaCIsImNvbnNvbGUiLCJlcnJvciIsImZpbmFsbHkiLCJhdmF0YXJGb3JtTW9kYWwiLCJpbnB1dFZhbHVlIiwidXBkYXRlVXNlckF2YXRhciIsImltZ0Zvcm1Nb2RhbCIsIl9yZWYzIiwiY3JlYXRlQ2FyZHMiLCJuZXdDYXJkIiwiY3JlYXRlQ2FyZCIsImltZ0Rpc3BsYXlQb3B1cCIsIl9wb3B1cEltYWdlIiwiX2NhcHRpb24iLCJpbWdVcmwiLCJjYXB0aW9uIiwiZGVsZXRlQ2FyZFBvcHVwIiwiX2NvbmZpcm1CdXR0b24iLCJfY29uZmlybUJ1dHRvblRleHQiLCJzZXRDb25maXJtQWN0aW9uIiwiY2FsbEJhY2siLCJvcHRpb25zIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2hhbmRsZUFwaVJlc3BvbnNlcyIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJfcmVxdWVzdCIsInVybCIsImZldGNoIiwiZ2V0SW5pdGlhbENhcmRzIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwidXBkYXRlTGlrZXMiLCJhYm91dCIsImF2YXRhclVybCIsImF1dGhvcml6YXRpb24iLCJpbWFnZVVybCIsImNhcmQiLCJfaWQiLCJhbGwiLCJ1c2VyRGF0YSIsImluaXRpYWxDYXJkcyIsImxvZyJdLCJzb3VyY2VSb290IjoiIn0=